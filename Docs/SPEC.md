# 游戏秘籍快捷输入工具 - 产品规格说明书

## 1. 项目概述

### 1.1 项目名称
GameCheatHelper - 游戏秘籍快捷输入助手

### 1.2 项目描述
一个基于 C# 和 Windows API 的桌面应用程序，用于在经典单机游戏（魔兽争霸3、星际争霸1）中通过快捷键快速输入官方游戏秘籍代码。

### 1.3 目标用户
- 单机游戏玩家
- 喜欢使用秘籍体验游戏的休闲玩家
- 需要快速测试游戏功能的用户

### 1.4 项目目标
- 提供便捷的秘籍输入方式
- 支持自定义快捷键
- 支持多款经典游戏
- 轻量级、低资源占用
- 用户友好的图形界面

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 游戏检测
- 自动检测魔兽争霸3和星际争霸1游戏进程
- 显示当前运行的游戏状态
- 仅在游戏运行时激活快捷键

#### 2.1.2 快捷键管理
- 全局快捷键监听（即使游戏在前台也能响应）
- 支持自定义快捷键绑定
- 防止快捷键冲突检测
- 快捷键配置持久化保存

#### 2.1.3 秘籍输入
- 自动切换到游戏窗口
- 模拟键盘输入秘籍代码
- 自动按下回车键确认
- 支持输入延迟配置（避免输入过快）

#### 2.1.4 秘籍库管理
- 内置常用秘籍库
- 支持添加自定义秘籍
- 秘籍分类管理
- 秘籍搜索功能

### 2.2 用户界面功能

#### 2.2.1 主窗口
- 游戏状态显示区
- 秘籍列表显示
- 快捷键配置面板
- 设置按钮

#### 2.2.2 秘籍管理界面
- 秘籍列表（网格视图）
- 添加/编辑/删除秘籍
- 快捷键绑定设置
- 秘籍描述和效果说明

#### 2.2.3 设置界面
- 输入延迟配置
- 开机自启动选项
- 最小化到托盘选项
- 语言切换（中文/英文）

### 2.3 系统功能

#### 2.3.1 配置管理
- JSON 格式配置文件
- 用户配置自动保存
- 配置导入/导出功能

#### 2.3.2 日志记录
- 操作日志记录
- 错误日志记录
- 日志文件自动清理

## 3. 支持的游戏和秘籍

### 3.1 魔兽争霸3 (Warcraft III)

| 秘籍代码 | 效果 | 默认快捷键 |
|---------|------|-----------|
| greedisgood | 获得500金和木材 | F1 |
| greedisgood 999999 | 获得指定数量金和木材 | F2 |
| iseedeadpeople | 显示全图 | F3 |
| whosyourdaddy | 无敌模式 | F4 |
| thereisnospoon | 无限魔法 | F5 |
| strengthandhonor | 不会失败 | F6 |
| itvexesme | 不会胜利 | F7 |
| somebodysetupusthebomb | 立即失败 | F8 |
| keysersoze | 获得500金 | Ctrl+F1 |
| leafittome | 获得500木材 | Ctrl+F2 |
| pointbreak | 移除食物上限 | Ctrl+F3 |
| warpten | 快速建造 | Ctrl+F4 |
| synergy | 关闭科技树需求 | Ctrl+F5 |

### 3.2 星际争霸1 (StarCraft)

| 秘籍代码 | 效果 | 默认快捷键 |
|---------|------|-----------|
| show me the money | 获得10000矿和气 | F1 |
| black sheep wall | 显示全图 | F2 |
| power overwhelming | 无敌模式 | F3 |
| operation cwal | 快速建造 | F4 |
| the gathering | 无限能量 | F5 |
| game over man | 任务失败 | F6 |
| staying alive | 继续游戏 | F7 |
| there is no cow level | 任务胜利 | F8 |
| whats mine is mine | 获得矿物 | Ctrl+F1 |
| breathe deep | 获得瓦斯 | Ctrl+F2 |
| something for nothing | 所有科技升级 | Ctrl+F3 |
| medieval man | 单位免费升级 | Ctrl+F4 |
| modify the phase variance | 可以建造所有建筑 | Ctrl+F5 |
| food for thought | 取消人口限制 | Ctrl+F6 |

## 4. 技术需求

### 4.1 开发环境
- .NET 6.0 或更高版本
- C# 10.0+
- Windows 10/11

### 4.2 核心技术
- Windows API (User32.dll)
  - RegisterHotKey - 注册全局热键
  - SendInput - 模拟键盘输入
  - FindWindow - 查找游戏窗口
  - SetForegroundWindow - 激活游戏窗口
- WPF (Windows Presentation Foundation) - UI框架
- System.Diagnostics.Process - 进程检测

### 4.3 第三方库
- Newtonsoft.Json - JSON配置文件处理
- NLog - 日志记录

## 5. 非功能性需求

### 5.1 性能要求
- 内存占用 < 50MB
- CPU占用 < 1%（待机状态）
- 快捷键响应时间 < 100ms
- 秘籍输入完成时间 < 500ms

### 5.2 可靠性要求
- 应用程序稳定运行，不崩溃
- 异常情况下优雅降级
- 配置文件损坏时使用默认配置

### 5.3 兼容性要求
- Windows 10 (1809+)
- Windows 11
- 支持中文和英文 Windows 系统

### 5.4 安全性要求
- 不修改游戏内存
- 不注入游戏进程
- 仅使用官方游戏秘籍功能
- 配置文件不包含敏感信息

### 5.5 可维护性要求
- 代码符合 C# 编码规范
- 关键功能有单元测试覆盖
- 清晰的代码注释
- 模块化设计，易于扩展

## 6. 约束和限制

### 6.1 技术约束
- 仅支持 Windows 平台
- 需要管理员权限（用于全局热键）
- 仅支持官方游戏版本

### 6.2 功能约束
- 仅限单机模式使用
- 不支持联机对战
- 不修改游戏文件

### 6.3 法律约束
- 仅使用游戏官方提供的秘籍功能
- 不破解或修改游戏程序
- 尊重游戏版权

## 7. 验收标准

### 7.1 功能验收
- [ ] 能够正确检测游戏进程
- [ ] 快捷键能够正常触发
- [ ] 秘籍能够成功输入到游戏中
- [ ] 配置能够正确保存和加载
- [ ] UI界面友好易用

### 7.2 性能验收
- [ ] 满足性能要求指标
- [ ] 无明显卡顿或延迟
- [ ] 资源占用在合理范围内

### 7.3 稳定性验收
- [ ] 连续运行24小时无崩溃
- [ ] 异常情况能够正确处理
- [ ] 日志记录完整

## 8. 交付物

- 可执行程序 (.exe)
- 用户手册 (UserGuide.md)
- 源代码
- 完整的文档（本文档及相关文档）
- 安装包（可选）

## 9. 后续扩展规划

### 9.1 功能扩展
- 支持更多经典游戏（帝国时代、红色警戒等）
- 秘籍组合功能（一键输入多个秘籍）
- 云同步配置

### 9.2 技术优化
- 性能优化
- 界面美化
- 多语言支持

---

**文档版本**: v1.0
**创建日期**: 2026-01-28
**最后更新**: 2026-01-28
**作者**: GameCheatHelper 开发团队
